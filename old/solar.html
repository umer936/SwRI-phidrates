<html>

<head>
<script LANGUAGE="JavaScript">

function testResults (form) {
    Ctrl = form.solar_activity;
    document.cookie = form.solar_activity.value;
    TestVar = isNumberString (form.solar_activity.value)
    if (TestVar == 0) {
        alert ("Number between 0 and 1 is required!")
        Ctrl.focus ();
        return;
    } 
    parent.left_frame.useBins = false;
    parent.left_frame.useSemiLog = false;
    TestVar = isBetweenXY (form.solar_activity.value, 0, 1)
    if (TestVar == 0) {
        alert ("Number between 0 and 1 is required!")
        Ctrl.focus ();
        return;
    } 
    if (document.solar.optical_depth.checked == true) {
        newpage = "construction.htm";
    } 
        else
    if (document.solar.plot_bin_spectrum.checked == true) {
        parent.left_frame.useBins = true;
        newpage = "plot_spectrum.html";
    }
        else 
    {
        newpage = "http://espsun.space.swri.edu/~joey/walter/photoabs.html";
    }
    if (document.solar.use_semi_log.checked == true) {
        parent.left_frame.useSemiLog = true;
    }
    location.href = newpage;
    return (newpage);
}


function isBetweenXY (value, lower, upper) {
    if (value < lower) return false;
    if (value > upper) return false;
    return true;
}

function isNumberString (InString) {
    if (InString.length == 0) return false;
    var RefString = "1234567890.";
    for (Count = 0; Count < InString.length; Count++) {
        TempChar = InString.substring (Count, Count+1);
        if (RefString.indexOf (TempChar, 0) == -1) 
            return (false);
    }
    return (true);
}
</script>

</head>
<body bgcolor="#000000" text="#FFFFFF" link="#000000" vlink="#000000"
 onLoad="">
<table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td>

<p align="center">&nbsp;</p>
</td></tr></table>
<table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td valign="top" width="1%">

<p>&nbsp;</p>
</td><td valign="top" width="24"></td><td valign="top">

<form NAME="solar" METHOD="GET"><!-- onSubmit="JavaScript:testResults(solar)"-->
  <p>Solar Activity : &nbsp;
  <input TYPE="text" NAME="solar_activity" VALUE="0.0" size="10"><BR> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
  (Quiet Sun = 0.00, Active Sun = 1.00)
  </p>
  <p>Input Optical Depth in Preassigned Wavelength Bins? 
  <input TYPE="checkbox" NAME="optical_depth" VALUE="off"> </p>
  <p>Plot Binned Spectrum? 
  <input TYPE="checkbox" NAME="plot_bin_spectrum" VALUE="off"> </p>
<P>
Plots are generally in log/log scale.  Check if you wish semi-log scale:
  <input TYPE="checkbox" NAME="use_semi_log" VALUE="off"> </p>
  <p>
</form>
<center>
<A HREF="Javascript:testResults (document.solar);">
<image SRC="greyoval-submit.gif" BORDER=0>
</A>
</center>
&nbsp;</td></tr></table>
</body>
</html>
